<h2 style="margin-bottom: 30px; font-size: 28px; font-weight: bold; color: #2c3e50; text-align: center;">
  📊 Employee Survey KPIs
</h2>

<div style="overflow-x: auto;">
  <table style="width: 100%; border-collapse: collapse; font-family: 'Segoe UI', sans-serif; font-size: 15px; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
    <thead style="background-color: #007bff; color: white;">
      <tr>
        <th style="padding: 12px; text-align: left;">👤 User</th>
        <th style="padding: 12px; text-align: left;">📝 Survey</th>
        <th style="padding: 12px; text-align: center;">📈 Engagement</th>
        <th style="padding: 12px; text-align: center;">⭐ High Perf %</th>
        <th style="padding: 12px; text-align: left;">📚 Category Breakdown</th>
      </tr>
    </thead>
    <tbody>
      <% @kpi_data.each do |entry| %>
        <tr style="border-bottom: 1px solid #eee;">
          <td style="padding: 12px;"><strong><%= entry[:user].name %></strong></td>
          <td style="padding: 12px;"><%= entry[:survey].title %></td>
          <td style="padding: 12px; text-align: center;">
            <span style="background-color: #e0f2ff; color: #007bff; padding: 5px 10px; border-radius: 5px;">
              <%= entry[:kpis][:engagement_index] %>%
            </span>
          </td>
          <td style="padding: 12px; text-align: center;">
            <span style="background-color: #d4edda; color: #155724; padding: 5px 10px; border-radius: 5px;">
              <%= entry[:kpis][:high_perf_percent] %>%
            </span>
          </td>
          <td style="padding: 12px;">
            <% if entry[:kpis][:average_score_by_category].present? %>
              <ul style="margin: 0; padding-left: 18px;">
                <% entry[:kpis][:average_score_by_category].each do |cat, score| %>
                  <li style="margin-bottom: 4px;">
                    <strong><%= cat.name %></strong>: <%= score %>
                    (<%= classify_score(score) %>)
                  </li>
                <% end %>
              </ul>
            <% else %>
              <span style="color: #888;">No responses</span>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <%= link_to "← Back to Dashboard", admin_dashboard_index_path,
            style: "margin-top: 24px; display: inline-block; padding: 8px 16px; background-color: #6c757d; color: white; border-radius: 4px; text-decoration: none;" %>


</div>
